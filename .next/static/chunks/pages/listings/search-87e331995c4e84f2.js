(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{7932:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/listings/search",function(){return a(4816)}])},4816:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSG:function(){return x},default:function(){return Search}});var s=a(5893),c=a(9008),l=a.n(c),i=a(7294),n=a(2964),d=a(2684),r=a(1163),o=a(7700),x=!0;function Search(e){let{appAuthToken:t}=e,{state:a,dispatch:c}=(0,i.useContext)(n.I),{query:o}=(0,r.useRouter)(),[x,u]=(0,i.useState)([]),[h,f]=(0,i.useState)(!0),[m,g]=(0,i.useState)("pending");function addToCart(e){let{currentTarget:t}=e,{id:a}=t.dataset;c({type:"add_to_cart",payload:{...x.find(e=>e._id===a),quantity:1}})}return(0,i.useEffect)(()=>{f(!0),g("pending"),fetch("/api/search?q=".concat(o.q,"&page=1"),{headers:{"X-Application-Authorization-Token":t}}).then(e=>e.json()).then(e=>{u(e),g("successful"),f(!1)}).catch(e=>{console.log(e),g("failed"),f(!1)})},[o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{children:(0,s.jsxs)("title",{children:["Search - ",o.q]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-6"}),(0,s.jsx)("div",{className:"".concat("successful"===m&&"grid"," grid-cols-4 gap-y-2 gap-x-4 max-[750px]:grid-cols-3 max-[500px]:grid-cols-2 max-[250px]:grid-cols-1"),children:h?(0,s.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Loading..."}):"failed"===m?(0,s.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Failed to load products"}):"all"===a.currentCategory?x.map(e=>(0,s.jsxs)("div",{"data-id":e._id,className:"hover:shadow-lg p-2 h-fit",children:[(0,s.jsx)("img",{alt:e.name,src:e.imageUrl,height:150,width:150,loading:"lazy",className:"block aspect-square align-center object-cover w-full"}),(0,s.jsx)("p",{className:"font-semibold text-sm capitalize",children:e.name}),(0,s.jsx)("div",{className:"flex gap-1 flex-col",children:(0,s.jsxs)("button",{onClick:addToCart,"data-id":e._id,className:"flex-grow flex items-center justify-center gap-1 text-sm px-2 py-1 rounded bg-blue-700 w-full text-white font-semibold active:scale-95",children:[(0,s.jsx)(d.rI6,{})," Add to cart"]})})]},e._id)):x.filter(e=>e.category===a.currentCategory).map(e=>(0,s.jsxs)("div",{"data-id":e._id,className:"hover:shadow-lg p-2 h-fit",children:[(0,s.jsx)("img",{alt:e.name,src:e.imageUrl,height:150,width:150,loading:"lazy",className:"block aspect-square align-center object-cover w-full"}),(0,s.jsx)("p",{className:"font-semibold text-sm",children:e.name}),(0,s.jsx)("div",{className:"flex gap-1 flex-col",children:(0,s.jsxs)("button",{onClick:addToCart,"data-id":e._id,className:"flex-grow flex items-center justify-center gap-1 text-sm px-2 py-1 rounded bg-blue-700 w-full text-white font-semibold active:scale-95",children:[(0,s.jsx)(d.rI6,{})," Add to cart"]})})]},e._id))}),a.fetchingMoreProducts[2]||(0,s.jsx)(d.fCD,{className:"m-auto text-zinc-600"})]})]})}Search.getLayout=e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l(),{children:[(0,s.jsx)("title",{children:"Search"}),(0,s.jsx)("meta",{name:"robots",content:"noindex, nofollow"})]}),(0,s.jsxs)(n.Z,{children:[e,(0,s.jsx)(o.Z,{})]})]})}},function(e){e.O(0,[12,774,888,179],function(){return e(e.s=7932)}),_N_E=e.O()}]);