(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45],{9145:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/listings",function(){return s(2118)}])},2118:function(t,e,s){"use strict";s.r(e),s.d(e,{__N_SSG:function(){return u},default:function(){return Listings}});var i=s(5893),o=s(7294),a=s(9008),n=s.n(a),c=s(2964),r=s(2684),l=s(1664),d=s.n(l),u=!0;function Listings(t){let{appAuthToken:e}=t,{state:s,dispatch:a}=(0,o.useContext)(c.I);function addToCart(t){let{currentTarget:e}=t,{id:i}=e.dataset;a({type:"add_to_cart",payload:s.products.find(t=>t._id===i)})}return(0,o.useEffect)(()=>{let t=1;async function getInitialProducts(){try{let t=await fetch("/api/listings?page=1",{headers:{"X-Application-Authorization-Token":e}});if(401===t.status||500===t.status){a({type:"set_product_fetch_status",payload:"failed"});return}let s=await t.json();a({type:"set_products",payload:[...s]})}catch(t){console.log(t),a({type:"set_product_fetch_status",payload:"failed"})}}async function getMoreProducts(){if(s.fetchingMoreProducts[2]||"failed"===s.fetchingMoreProducts[1]||"success"===s.fetchingMoreProducts[1])try{a({type:"set_more_products",payload:{category:s.currentCategory,status:"pending",finished:!1}});let i=await fetch("/api/listings?page=".concat(t++,"&category=").concat(s.currentCategory),{headers:{"X-Application-Authorization-Token":e}});if(401===i.status||500===i.status){a({type:"set_more_products",payload:{category:s.currentCategory,status:"failed",finished:!0}});return}let o=await i.json();a({type:"set_more_products",payload:{category:s.currentCategory,status:"success",data:[...o],finished:!0}})}catch(t){console.log(t),a({type:"set_product_fetch_status",payload:"failed"})}}function scroll(){if(document.documentElement.scrollHeight-(window.scrollY+this.window.innerHeight)<=300){console.log("True"),getMoreProducts();return}}return window.addEventListener("scroll",scroll),getInitialProducts(),()=>{window.removeEventListener("scroll",scroll)}},[]),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mb-6"}),(0,i.jsx)("div",{className:"".concat("success"===s.productFetchStatus&&"grid"," grid-cols-4 gap-y-2 gap-x-4 max-[750px]:grid-cols-3 max-[500px]:grid-cols-2 max-[250px]:grid-cols-1"),children:s.fetchingProducts?(0,i.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Loading..."}):"failed"===s.productFetchStatus?(0,i.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Failed to load products"}):s.products.map(t=>(0,i.jsxs)("div",{"data-id":t._id,className:"hover:shadow-lg p-2 h-fit",children:[(0,i.jsx)("img",{alt:t.name,src:t.imageUrl,height:150,width:150,loading:"lazy",className:"block aspect-square align-center object-cover w-full"}),(0,i.jsx)("small",{className:"font-semibold",children:t.name}),(0,i.jsxs)("p",{className:"font-bold",children:[(0,i.jsx)("sub",{children:"â‚¦"}),t.price]}),(0,i.jsxs)("div",{className:"flex gap-1 flex-col",children:[(0,i.jsxs)("button",{onClick:addToCart,"data-id":t._id,className:"flex-grow flex items-center justify-center gap-1 text-sm px-2 py-1 rounded bg-blue-500 w-full text-white font-semibold active:scale-95",children:[(0,i.jsx)(r.rI6,{})," Add to cart"]}),(0,i.jsx)(d(),{className:"text-[12px] bg-slate-200 rounded px-2 py-1 text-center",href:"/listings/".concat(t._id),children:"View product"})]})]},t._id))}),s.fetchingMoreProducts[2]||(0,i.jsx)(r.fCD,{className:"m-auto text-zinc-600"})]})}Listings.getLayout=function(t){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n(),{children:[(0,i.jsx)("title",{children:"Product Listings | IYKE-BULKWILL"}),(0,i.jsx)("meta",{name:"description",content:"Check out our listings to see our exclusive offers"}),(0,i.jsx)("meta",{name:"og:title",content:"IYKE_BULKWILL - Product Listings"}),(0,i.jsx)("meta",{name:"og:description",content:"Check out our listings to see our exclusive offers"}),(0,i.jsx)("meta",{name:"og:image",content:"https://iyke-bulkwill.com/images/og_image.png"}),(0,i.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,i.jsx)("meta",{name:"twitter:title",content:"Product Listings | IYKE-BULKWILL"}),(0,i.jsx)("meta",{name:"twitter:description",content:"Check out our listings to see our exclusive offers"}),(0,i.jsx)("meta",{name:"twitter:image",content:"https://iyke-bulkwill.com/images/og_image.png"})]}),(0,i.jsx)(c.Z,{children:t})]})}}},function(t){t.O(0,[714,736,172,774,888,179],function(){return t(t.s=9145)}),_N_E=t.O()}]);