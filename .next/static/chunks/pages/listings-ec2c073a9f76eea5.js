(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45],{9145:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/listings",function(){return s(2118)}])},2118:function(t,e,s){"use strict";s.r(e),s.d(e,{__N_SSG:function(){return d},default:function(){return Listings}});var a=s(5893),i=s(7294),o=s(9008),c=s.n(o),n=s(2964),r=s(2684),l=s(7700),d=!0;function Listings(t){let{appAuthToken:e}=t,{state:s,dispatch:o}=(0,i.useContext)(n.I);function addToCart(t){let{currentTarget:e}=t,{id:a}=e.dataset;o({type:"add_to_cart",payload:{...s.products.find(t=>t._id===a),quantity:1}})}return(0,i.useEffect)(()=>{let t=1;async function getInitialProducts(){try{let t=await fetch("/api/listings?page=1&category=".concat(s.currentCategory),{headers:{"X-Application-Authorization-Token":e}});if(401===t.status||500===t.status){o({type:"set_product_fetch_status",payload:"failed"});return}let a=await t.json();o({type:"set_products",payload:[...a]})}catch(t){console.log(t),o({type:"set_product_fetch_status",payload:"failed"})}}async function getMoreProducts(a){if(s.fetchingMoreProducts[2]||"failed"===s.fetchingMoreProducts[1]||"success"===s.fetchingMoreProducts[1])try{t++,o({type:"set_more_products",payload:{category:a,status:"pending",finished:!1}});let s=await fetch("/api/listings?page=".concat(t,"&category=").concat(a),{headers:{"X-Application-Authorization-Token":e}});if(401===s.status||500===s.status){o({type:"set_more_products",payload:{category:a,status:"failed",finished:!0}});return}let i=await s.json();o({type:"set_more_products",payload:{category:a,status:"success",data:[...i],finished:!0}})}catch(t){console.error(t),o({type:"set_product_fetch_status",payload:"failed"})}}function scroll(){if(document.documentElement.scrollHeight-(window.scrollY+this.window.innerHeight)<=300){getMoreProducts(s.currentCategory);return}}return window.addEventListener("scroll",scroll),getInitialProducts(),()=>{window.removeEventListener("scroll",scroll),o({type:"set_products",payload:[]}),t=1}},[s.currentCategory]),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-6"}),(0,a.jsx)("div",{className:"".concat("success"===s.productFetchStatus&&"grid"," grid-cols-4 gap-y-2 gap-x-4 max-[750px]:grid-cols-3 max-[500px]:grid-cols-2 max-[250px]:grid-cols-1"),children:s.fetchingProducts?(0,a.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Loading..."}):"failed"===s.productFetchStatus?(0,a.jsx)("p",{className:"font-semibold text-slate-300 text-center",children:"Failed to load products"}):s.products.map(t=>(0,a.jsxs)("div",{"data-id":t._id,className:"hover:shadow-lg p-2 h-fit",children:[(0,a.jsx)("img",{alt:t.name,src:t.imageUrl,height:150,width:150,loading:"lazy",className:"block aspect-square align-center object-cover w-full"}),(0,a.jsx)("p",{className:"font-semibold text-sm capitalize",children:t.name}),(0,a.jsx)("div",{className:"flex gap-1 flex-col",children:(0,a.jsxs)("button",{onClick:addToCart,"data-id":t._id,className:"flex-grow flex items-center justify-center gap-1 text-sm px-2 py-1 rounded bg-blue-500 w-full text-white font-semibold active:scale-95",children:[(0,a.jsx)(r.rI6,{})," Add to cart"]})})]},t._id))}),s.fetchingMoreProducts[2]||(0,a.jsx)(r.fCD,{className:"m-auto text-zinc-600"})]})}Listings.getLayout=function(t){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{children:[(0,a.jsx)("title",{children:"Exclusive Offers and Affordable Prices | Products Listings - Iyke Bulkwill"}),(0,a.jsx)("meta",{name:"description",content:"Check out our listings to see our exclusive offers"}),(0,a.jsx)("meta",{name:"og:title",content:"IYKE_BULKWILL - Product Listings"}),(0,a.jsx)("meta",{name:"og:description",content:"Check out our listings to see our exclusive offers"}),(0,a.jsx)("meta",{name:"og:image",content:"https://iyke-bulkwill.com/images/og_image.png"}),(0,a.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,a.jsx)("meta",{name:"twitter:title",content:"Product Listings | IYKE-BULKWILL"}),(0,a.jsx)("meta",{name:"twitter:description",content:"Check out our listings to see our exclusive offers"}),(0,a.jsx)("meta",{name:"twitter:image",content:"https://iyke-bulkwill.com/images/og_image.png"})]}),(0,a.jsxs)(n.Z,{children:[t,(0,a.jsx)(l.Z,{})]})]})}}},function(t){t.O(0,[12,774,888,179],function(){return t(t.s=9145)}),_N_E=t.O()}]);